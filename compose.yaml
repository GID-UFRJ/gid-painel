services:
  gid-painel:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DJANGO_SECRET_KEY=sua_chave_secreta_aqui # python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
      - DJANGO_DEBUG=False
      - POSTGRES_USER=gid
      - POSTGRES_NAME=gid_db # database name
      - POSTGRES_PASSWORD=gid_dashboard
      - POSTGRES_HOST=postgres # database server service name
      - POSTGRES_PORT=5432 #default port
    volumes:
      - static_volume:/app/staticfiles  # Volume para arquivos estáticos
      - importar:/app/importar # Volume para arquivos usados para população inicial da db
    depends_on:
      - postgres

  postgres:
    image: postgres:17.5
    environment: 
      - POSTGRES_USER=gid
      - POSTGRES_PASSWORD=gid_dashboard
      - POSTGRES_DB=gid_db
    ports:
      - "5433:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  #caddy:
  #  image: caddy:latest
  #  ports:
  #    - "80:80"
  #    - "443:443"  # Para HTTPS automático
  #  volumes:
  #    - ./caddy/Caddyfile:/etc/caddy/Caddyfile
  #    - caddy_data:/data  # Para armazenar certificados SSL
  #    - caddy_config:/config
  #    - static_volume:/app/staticfiles
  #    - media_volume:/app/media
  #  depends_on:
  #    - gid-painel

volumes:
  postgres_data:
  static_volume:
  media_volume:
  importar:
  #caddy_data:
  #caddy_config: 
